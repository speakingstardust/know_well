var ready; 
ready = function () {
  google.charts.load('current', { packages: ['gantt']});
  google.charts.setOnLoadCallback(drawChart);

  // function daysToMiliseconds(days) {
  //  return days * 24 * 60 * 60 * 1000;
  // }

  function parse_rows(rows) {
    rows.forEach(function(row) {
      row[2] = new Date(row[2]);
      row[3] = new Date(row[3]);
      if (row[6] === "") {
        row[6] = null;
      }
    });
    return rows;
  }

  function drawChart() {

  var data = new google.visualization.DataTable();
  data.addColumn('string', 'Task ID');
  data.addColumn('string', 'Task Name');
  data.addColumn('date', 'Start Date');
  data.addColumn('date', 'End Date');
  data.addColumn('number', 'Duration');
  data.addColumn('number', 'Percent Complete');
  data.addColumn('string', 'Dependencies');

  var rows = parse_rows(gon.rows);

  data.addRows(rows);

  var options = {
    height: gon.height
  };

  var chart = new google.visualization.Gantt(document.getElementById('chart'));

    chart.draw(data, options);
  }
}

$(document).ready(ready);
$(document).on('page:load', ready);
